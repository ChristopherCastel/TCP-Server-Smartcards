/*
 * main.cpp
 *
 *  Created on: 28 Feb 2019
 *      Author: Castel Christopher
 */

#include "client/client_api.h"
#include "client/requests/command.h"
#include "client/requests/diag.h"
#include "client/requests/disconnect.h"
#include "client/requests/echo.h"
#include "client/requests/flyweight_requests.h"
#include "terminal/flyweight_terminal_factory.h"
#include "terminal/terminals/terminal_pcsc.h"

using namespace client;

int __cdecl main(void) {
	// config available terminal factories
	FlyweightTerminalFactory available_terminals;
	available_terminals.addFactory("PCSC", new PCSCFactory());

	// config requests client can handle
	FlyweightRequests available_requests;
	available_requests.addRequest("ECHO", new Echo());

	ClientAPI client;
	client.initClient("./config/init.json", available_terminals);
	client.connectClient();
	return 0;
}
